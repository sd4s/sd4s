--Report name : UNI00036R_dispersion	
--
--[Product & Process development ]
--    - [ Athena testing ]
--      - [ Dispersion ]
--TOP-FILTER: LOV PART-NO + IMPORTID
--

--***********************************************************
--UNILAB-VIEWS
--***********************************************************

--let op: WE GAAN HIER GEBRUIK MAKEN VAN DE ALGEMENE SAMPLE-PART-NO-GROUPKEY-VIEW !!!!!!!!!!!!!


--**********************************
--SAMPLE_METHOD_IMPORTID_GROUPKEY
--**********************************
--Haal alle IMPORT-ID's behorende met SAMPLE related aan PART-NO die bij gerelateerde METHODS voorkomen.
--column = PRODUCTION_DATE = TRUNC(SYSDATE)

DROP VIEW sc_lims_dal.av_sample_partno_importid_groupkey;
--
create or replace view sc_lims_dal.av_sample_partno_importid_groupkey
(part_number                         
,sample_code                         
,parameter
,parameter_node
,method
,method_node
,method_status
,import_id
)
as
select scgk.part_no          as part_number
,      me.sc                 as sample_code
,      me.pa                 as parameter
,      me.panode             as parameter_node
,      me.me                 as method
,      me.menode             as method_node
,      me.ss                 as method_status
,      megk.importid         as import_id
from utscme                   me
JOIN utscmegkimportid       megk on (megk.sc = me.sc and megk.pg = me.pg and megk.pgnode = me.pgnode and megk.pa = me.pa and megk.panode = me.panode and megk.me = me.me and megk.menode = me.menode)
JOIN utscmegkpart_no        scgk on (scgk.sc = me.sc and scgk.pg = me.pg and scgk.pgnode = me.pgnode and scgk.pa = me.pa and scgk.panode = me.panode and scgk.me = me.me and scgk.menode = me.menode)
JOIN utscmegkme_is_relevant meir on (meir.sc = me.sc and meir.pg = me.pg and meir.pgnode = me.pgnode and meir.pa = me.pa and meir.panode = me.panode and meir.me = me.me and meir.menode = me.menode and meir.me_is_relevant = '1')
WHERE me.ss  IN ('AV', '@P', 'IE', 'WA', 'SU', 'ER')
--AND part_no = 'EF_Y275/30R20WPRX'
; 
--23.955.WTR01	Noise R117 label	TT872A	23471007	

--table-comment:
comment on VIEW sc_lims_dal.av_sample_partno_importid_groupkey is 'Contains all UNILAB-SAMPLE-METHOD GROUPKEYS with IMPORT-IDs';

grant all on  sc_lims_dal.av_sample_partno_importid_groupkey   to usr_rna_readonly1;


/*
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AJ	12000000	TT341X	2000000	CM	22230367
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AJ	12000000	TT341X	3000000	CM	22230368
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AJ	12000000	TT341X	4000000	CM	22230369
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AD	13000000	TT341X	2000000	CM	22230370
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AD	13000000	TT341X	3000000	CM	22230371
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AD	13000000	TT341X	4000000	CM	22230372
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661AC	5000000	TT661XX	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661BC	6000000	TT661XX	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT321AC	7000000	TT321X	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661AA	8000000	TT661XX	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661BA	9000000	TT661XX	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT321AA	10000000	TT321X	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661ZZ	11000000	TT530Z	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661ZZ	11000000	TT661ZZ	2000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT341AD	12000000	TT341X	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT341ZZ	13000000	TT341ZZ	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661DJ	4000000	TT661XX	1000000	CM	22230201
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT321AJ	5000000	TT321X	1000000	CM	22230189
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661AD	6000000	TT661XX	1000000	CM	22230194
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661BD	7000000	TT661XX	1000000	CM	22230198
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT321AD	8000000	TT321X	1000000	CM	22230188
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661AA	9000000	TT661XX	1000000	CM	22230192
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661BA	10000000	TT661XX	1000000	CM	22230196
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT321AA	11000000	TT321X	1000000	CM	22230186
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AJ	12000000	TT341X	1000000	CM	22230191
EF_650/65R42TRO174	MTD2328069T01	Preparation CA	1000000	PT110A	1000000	PT110A	1000000	CM	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT545AA	1000000	TT530A	1000000	@C	22221029
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT545AA	1000000	CT006F	2000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT545AA	1000000	TT545A	3000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT661AD	2000000	TT661XX	1000000	@C	22221186
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT661BD	3000000	TT661XX	1000000	@C	22221189
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT661CD	4000000	TT661XX	1000000	@C	22221190
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT321AD	5000000	TT321X	1000000	@C	22221182
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT661AC	6000000	TT661XX	1000000	@C	22221185
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT661BC	7000000	TT661XX	1000000	@C	22221188
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT321AC	8000000	TT321X	1000000	@C	22221181
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT661AA	9000000	TT661XX	1000000	@C	22221184
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT661BA	10000000	TT661XX	1000000	@C	22221187
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT321AA	11000000	TT321X	1000000	@C	22221180
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor A8B 160	2500000	TT341AD	12000000	TT341X	1000000	@C	22221183
EF_650/65R42TRO174	KAM2222000T01	Indoor testing	1000000	TT545AA	1000000	TT530A	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	Indoor testing	1000000	TT545AA	1000000	TT545A	3000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661AD	1000000	TT661XX	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661BD	2000000	TT661XX	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT661DD	3000000	TT661XX	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS All	2000000	TT321AD	4000000	TT321X	1000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT545AA	1000000	TT530A	1000000	CM	22221030
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT545AA	1000000	CT006F	2000000	CM	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT545AA	1000000	TT545A	3000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661AJ	2000000	TT661XX	1000000	CM	22230195
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661BJ	3000000	TT661XX	1000000	CM	22230199
EF_650/65R42TRO174	WTR2411119T01	Indoor testing	1000000	TT751AA	1000000	TT530A	1000000	CM	24120081
EF_650/65R42TRO174	WTR2411119T01	Indoor testing	1000000	TT751AA	1000000	CT006F	2000000	CM	
EF_650/65R42TRO174	WTR2411119T01	Indoor testing	1000000	TT751AA	1000000	TT545A	3000000	CM	
EF_650/65R42TRO174	WTR2411119T01	Indoor testing	1000000	TT751AA	1000000	TT610A	5000000	AV	
EF_650/65R42TRO174	WTR2411119T01	Indoor testing	1000000	TT751AA	1000000	TT751A	4000000	CM	24120526
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT341AD	13000000	TT341X	1000000	CM	22230190
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661AC	14000000	TT661XX	1000000	CM	22230193
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661BC	15000000	TT661XX	1000000	CM	22230197
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT321AC	16000000	TT321X	1000000	CM	22230187
EF_650/65R42TRO174	KAM2222000T01	Indoor testing	1000000	TT545AA	1000000	CT006F	2000000	@C	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT545AA	1000000	TT545A	4000000	CM	
EF_650/65R42TRO174	KAM2222000T01	FPS Tractor D 200	3000000	TT661DD	17000000	TT661XX	1000000	CM	22230200
EF_650/65R42TRO174	HOB2318013T01	FPS All	1000000	TT661ZZ	1000000	TT530Z	1000000	@P	
EF_650/65R42TRO174	HOB2318013T01	FPS All	1000000	TT661ZZ	1000000	TT661ZZ	2000000	@P	
EF_650/65R42TRO174	HOB2318013T01	FPS All	1000000	TT321ZZ	2000000	TT321ZZ	1000000	@P	
EF_650/65R42TRO174	HOB2318013T01	FPS All	1000000	TT661ZZ	3000000	TT661ZZ	1000000	@P	
EF_650/65R42TRO174	HOB2318013T01	FPS All	1000000	TT321ZZ	4000000	TT321ZZ	1000000	@P	
*/







--TOP FILTER-QUERY PART-NO 
select  distinct s.part_number 
from sc_lims_dal.av_sample_partno_importid_groupkey  s
order by s.part_number
;

--TOP FILTER-QUERY IMPORT-ID  (obv part-no)
select  distinct s.import_id
from sc_lims_dal.av_sample_partno_importid_groupkey  s
where s.part_number = 'EF_Y275/30R20WPRX'
order by s.import_id
;



--FOR TAB: BOM see VIEW           av_reqov_bom_explosion_parts             (<duplicate 1.2.6.2>  or <1.1.2.5.1.1> )!!! 

--FOR FILTER-OPTION = BOM-TREE + RAW-MATERIALS see view  av_exec_db_partno_dispersion      (<duplicate 2.1.1.3.1>   ==>  EXECUTION-DASHBOARD !!!!!!   )  

--UITVRAGEN BOM-EXPLOSION!!!!!!!!!!!


select * 
from av_exec_db_partno_dispersion
where ROOT_part = 'EF_650/65R42TRO174'
order by RPAD( replace( PATH||'.'|| PATHNODE ,' ','') ,64,'.0000')
;

select * 
from av_exec_db_partno_dispersion
where ROOT_part = 'EM_721'
order by RPAD( replace( PATH||'.'|| PATHNODE ,' ','') ,64,'.0000')
;


--einde script


