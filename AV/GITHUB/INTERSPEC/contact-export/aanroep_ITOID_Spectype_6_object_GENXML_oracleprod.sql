--Aanroep: @aanroep_ITOID_Spectype_6_object_GENXML_oracleprod.sql
--
--per file-type
-- @select_ITOID_SafetyDataSheets_PDF_GENXML.sql   701035   pdf     0,1,2,3,4,5,6,7,8,9  
-- @select_ITOID_SafetyDataSheets_PDF_GENXML.sql   701035   txt     0,1,2,3,4,5,6,7,8,9  
-- @select_ITOID_SafetyDataSheets_PDF_GENXML.sql   701035   CATPart 0,1,2,3,4,5,6,7,8,9  
-- @select_ITOID_SafetyDataSheets_PDF_GENXML.sql   701035   stp     0,1,2,3,4,5,6,7,8,9  
-- @select_ITOID_SafetyDataSheets_PDF_GENXML.sql   701035   inc     0,1,2,3,4,5,6,7,8,9  
-- @select_ITOID_SafetyDataSheets_PDF_GENXML.sql   701035   xls     0,1,2,3,4,5,6,7,8,9  
-- @select_ITOID_SafetyDataSheets_PDF_GENXML.sql   701035   doc     0,1,2,3,4,5,6,7,8,9  
--
--total ORACLEPROD:
--700577	Chemical and physical properties
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700577   alle   0,1,2,3,4,5,6,7,8,9   
--700578	Controlplan
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700578   alle    0,1,2,3,4,5,6,7,8,9  
--700579	General information	
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700579   alle     0,1,2,3,4,5,6,7,8,9 
--700580	Global specification	
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700580   alle    0,1,2,3,4,5,6,7,8,9  
--700581	Storage, Logistics & Packaging
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700581   alle    0,1,2,3,4,5,6,7,8,9  
--700582	Permissable deviations
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700582   alle    0,1,2,3,4,5,6,7,8,9  
--700583	Processing
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700583   alle    0,1,2,3,4,5,6,7,8,9  
--700584	Properties
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700584   alle    0,1,2,3,4,5,6,7,8,9  
--700586	TCE	
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700586   alle   0,1,2,3,4,5,6,7,8,9   
--700635	Safety Datasheet
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700635   alle   0,1,2,3,4,5,6,7,8,9   
--700935	Design Information	
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700935   alle   0,1,2,3,4,5,6,7,8,9   
--700955	Specification
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   700955   alle   0,1,2,3,4,5,6,7,8,9   
--701015	FEA material definition	
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   701015   alle   0,1,2,3,4,5,6,7,8,9   
--701035	QESH	
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   701035   alle   0,1,2,3,4,5,6,7,8,9   
--701058	Processing Gyongyoshalasz	
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   701058   alle  0,1,2,3,4,5,6,7,8,9    
--701155	New Vendor and raw material development request
--@select_ITOID_SafetyDataSheets_PDF_GENXML_oracleprod.sql   701155   alle  0,1,2,3,4,5,6,7,8,9    
--
--Te groot om in 1x te verwerken:
--700835	D-spec  (=te groot voor 1x, OBJECT_ID like 1,4,5,6,7,8,9)
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  100                
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  101,102,103        
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  104,105,106,107    
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  108,109,110        
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  4                  
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  5
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  60,61,62,63,64 
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  65,66,67,68.69 
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  70,71,72,73
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  74,75,76,77,78,79
--   @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  80,81,82,83,84
-- @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  85,86,87,88,89
-- @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  90,91,92,93
-- @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  94,95
-- @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   700835   alle  96,97,98,99
--
--701095	Labels and certification (=te groot, only 100 rows!!!)
-- @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   701095   alle     5,7,8,66,67,69     
-- @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   701095   alle     64
-- @select_ITOID_Spectype_6_object_GENXML_oracleprod.sql   701095   alle     65


-- LET OP: SCRIPT DRAAIEN ALS SCRIPT, NIET MET KNIPPEN/PLAKKEN IN SQL*PLUS/DEVELOPER OMDAT WE ANDERS
--         DE TERMOUT-REGELS ER NOG UIT MOETEN HALEN.

--********************************************************
--Script om data uit Specification tables te selecteren.
--To export data from Interspec for CONTACT-software.
--********************************************************
--COMBINATION OF 2 QUERIES
-- THIS QUERY WILL EXPORT TO XML!!!
-- based on Specification tables To export data from Interspec
--
--************************************************************
--SPECIFICATION-TYPE:
--when sps.type = 1 then 'Property Group'
--when sps.type = 2 then 'Reference Text'
--when sps.type = 3 then 'BOM'
--when sps.type = 4 then 'Single Property'
--when sps.type = 5 then 'Free Text'
--when sps.type = 6 then 'Object'
--when sps.type = 7 then 'Process Data'
--when sps.type = 8 then 'Attached Specification'
--when sps.type = 9 then 'Ingredient List'
--when sps.type = 10 then 'Base Name'
--
--SECTION:   700635	 Safety Datasheet
--
--SELECT sps.section_id, sps.type, count(*) from specification_section sps where section_id = 700635 group by sps.section_id, sps.type
--700635	6	7824   --> only this one related to ITOID !!!!
--700635	1	2059
--700635	5	309
--
--
/*
--select all SECTIONS from TYPE=6=Object:
--
SELECT sps.section_id, s.description, sps.type, count(*) 
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner 
JOIN section               s    on s.section_id = sps.section_id 
JOIN specification_header  sh   ON  sh.part_no = sps.part_no AND sh.revision = sps.revision
JOIN status                st   ON  st.status = sh.status AND st.status_type = 'CURRENT'
where sps.type = 6 
group by sps.section_id, s.description, sps.type
order by sps.section_id, s.description, sps.type
;
*/

/*
--CURRENT-STATUS INCL. occurrence in ITOID !!!!:
700577	Chemical and physical properties				6	83
700578	Controlplan										6	4
700579	General information								6	122
700580	Global specification							6	21197          --done oracleprod
700581	Storage, Logistics & Packaging					6	26            --DONE
700582	Permissable deviations							6	548				--done
700583	Processing										6	404             --done oracleprod
700584	Properties										6	70
700586	TCE												6	37630           --done oracleprod    
700635	Safety Datasheet								6	1094			--done safety-data-sheets !!! (original send to contact)
700835	D-spec											6	23717           -- Te groot !!!. Meer dan 15GB result predicted !!!!
700935	Design Information								6	809             --done
700955	Specification									6	1				--done
701015	FEA material definition							6	4761            --done oracleprod
701035	QESH											6	1594           --done = qesh
701058	Processing Gyongyoshalasz						6	30
701095	Labels and certification						6	1027			--LOOPT, maar afgebroken, neemt meer dan 9 GB TEMP-space in beslag !!!
701155	New Vendor and raw material development request	6	1
--
--701095, voor 100-rows met linesize=100, nam hij 1GB TEMP-space, en maakt hij XML van 300 MB aan. Vanaf LAPTOP=1 uur, OracleProd=1min.
*/
/*
--all STATUS:
701035	QESH								6	4553      
700582	Permissable deviations				6	804
700635	Safety Datasheet					6	7824       
700581	Storage, Logistics & Packaging		6	76
700955	Specification						6	58
701095	Labels and certification			6	30726
700815	Summary								6	68
700580	Global specification				6	28448
700583	Processing							6	2651
701058	Processing Gyongyoshalasz			6	275
700855	Include (files)						6	19
701155	New Vendor and raw material development request	6	4
701015	FEA material definition				6	60244
700935	Design Information					6	8517
700577	Chemical and physical properties	6	670
700578	Controlplan							6	854
700579	General information					6	497
700586	TCE									6	45517
700835	D-spec								6	86230
700584	Properties							6	715
*/

/*
--VOORONDERZOEK RESULTS/PERFORMANCE
select count(*) from specification_section;
--8.024.266
select count(*) from itoid;
--59.122
select count(distinct OBJECT_ID) from itoid;
--59.005
select count(*) from itoiraw;
--59.122  (=gelijk aan itoid !!!)
*/

/*
select count(*)
select count(sps.part_no)
--

--SELECT /+ LEADING(ITOID) INDEX(sps PK_SPECIFICATION_SECTION) / sps.part_no, sps.revision, sps.section_id, sps.sub_section_id, sps.ref_id, sps.ref_ver, sps.type, i.file_name, i.revision, r.object_id, r.revision    --, r.desktop_object
select sps.part_no, sps.revision, sps.section_id, sps.sub_section_id, sps.ref_id, sps.ref_ver, sps.type, i.file_name, i.revision, r.object_id, r.revision    --, r.desktop_object
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner 
JOIN specification_header  sh    ON  sh.part_no = sps.part_no AND sh.revision = sps.revision
JOIN status  s                   ON  s.status = sh.status AND s.status_type = 'CURRENT'
JOIN ITOIRAW r  ON  i.object_id = r.object_id AND   i.revision  = r.revision 
where sps.type = 6 
and   (   (   substr(i.file_name, instr(i.file_name,'.',-1)+1)     like decode('overig','overig','%','overig')
          and   substr(i.file_name, instr(i.file_name,'.',-1)+1) NOT IN ('pdf','txt','CATPart','stp','inc','xls','doc')
		  )
      or   substr(i.file_name, instr(i.file_name,'.',-1)+1) like 'doc'
	  )
--and   sps.revision = (select max(sps2.revision) 
--                      from specification_section sps2 
--					  where sps2.part_no = sps.part_no 
--					  and sps2.ref_id = sps.ref_id 
--					  and sps2.ref_ver = sps.ref_ver )
;
--order by 1 ,2

--AANTAL TOTAAL PARTNO-REFID: 150806
--AANTAL DISTINCT REF-ID: 52423
--AANTAL DISTINCT PARTNO-REFID: 133294

102283B_MIL_GEN	1	701035	0	104479	6	MSDS_102283B_milliken code 2283.pdf	1	104479	1
102283B_MIL_GEN	1	701035	0	104479	6	MSDS_102283B_milliken code 2283.pdf	1	104479	1
102283B_MIL_GEN	1	701035	0	104479	6	MSDS_102283B_milliken code 2283.pdf	1	104479	1

select * from specification_section where part_no = '102283B_MIL_GEN' ; 
--part-no komt met meerdere REVISION voor, bij hetzelfde REF-ID/REF-VER !!!


SELECT substr(sps.part_no,1,3) , count(*)
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner 
JOIN ITOIRAW r  ON  i.object_id = r.object_id AND   i.revision  = r.revision 
where sps.type = 6 
and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(sps.part_no,1,3)
;
--133.000
--CONCLUSIE: Er komen PART-NO voor met meerdere REF-TEXTs!!

SELECT sps.part_no, sps.type, i.object_id, count(*)
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 700635
JOIN ITOIRAW r  ON  i.object_id = r.object_id AND   i.revision  = r.revision 
where sps.type in ( 6 )
and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by sps.part_no
having count(*) > 1
;
130901_ASA_SIN	2
164312_EVE_EIJ	3
140203_TOT_HAR	2
160774_LAN_DOR	3
130962B_GRP_ANK	2
160326_RHE_USA	3
--
160007_MDH_MEH	63109	1

--onderzoek type bestanden...
select substr(i.file_name, instr(i.file_name,'.',-1)+1) ext, count(*)
from ITOID i
--where substr(i.file_name, instr(i.file_name,'.',-1)+1) like 'doc'
group by substr(i.file_name, instr(i.file_name,'.',-1)+1)
;
/*
pdf	23964
txt	16783
CATPart	9335
stp	6462
inc	388
xls	316
doc	293
...
etc
*/


/*
--FILE-FORMATS ONLY FOR CURRENT SPECS FOR SECTION-ID = 700635 !!!
--
SELECT substr(i.file_name, instr(i.file_name,'.',-1)+1) ext, count(*)
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 700635
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
ORDER by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
;

5 ENG	1
DOC		1
PDF		26
doc		50
docx	2
msg		5
pdf		1003
rtf		2
tif		2
--
--NOT IN ('5 ENG')
*/

/*
--FILE-FORMATS ONLY FOR CURRENT SPECS FOR SECTION-ID = 701035 !!!
--
SELECT substr(i.file_name, instr(i.file_name,'.',-1)+1) ext, (sum(length(r.desktop_object))/1024/1024) mb_size, count(*)
from ITOID   i
JOIN ITOIRAW r                   ON  i.object_id = r.object_id AND   i.revision  = r.revision 
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 701035
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
ORDER by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
;
--
PDF		28.64389514923095703125		90
html	0.05043792724609375			1
pdf		647.20726680755615234375	1502
tif		0.351898193359375			1
*/

--700582
/*
--FILE-FORMATS ONLY FOR CURRENT SPECS FOR SECTION-ID = 700582 !!!
--
SELECT substr(i.file_name, instr(i.file_name,'.',-1)+1) ext, (sum(length(r.desktop_object))/1024/1024) mb_size, count(*)
from ITOID   i
JOIN ITOIRAW r                   ON  i.object_id = r.object_id AND   i.revision  = r.revision 
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 700582
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
ORDER by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
;
--
doc	11.7734375	548
*/

--701095	Labels and certification
/*
--FILE-FORMATS ONLY FOR CURRENT SPECS FOR SECTION-ID = 701095 !!!
--
SELECT substr(i.file_name, instr(i.file_name,'.',-1)+1) ext, (sum(length(r.desktop_object))/1024/1024) mb_size, count(*)
from ITOID   i
JOIN ITOIRAW r                   ON  i.object_id = r.object_id AND   i.revision  = r.revision 
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 701095
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
ORDER by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
;
--
pdf	1298.47996044158935546875	1027

*/

--700583
/*
--FILE-FORMATS ONLY FOR CURRENT SPECS FOR SECTION-ID = 701095 !!!
--
SELECT substr(i.file_name, instr(i.file_name,'.',-1)+1) ext, (sum(length(r.desktop_object))/1024/1024) mb_size, count(*)
from ITOID   i
JOIN ITOIRAW r                   ON  i.object_id = r.object_id AND   i.revision  = r.revision 
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 700583
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
ORDER by substr(i.file_name, instr(i.file_name,'.',-1)+1) 
;
--
EXT                                         MB_SIZE   COUNT(*)
---------------------------------------- ---------- ----------
xls                                      24.7119141        305
xlsx                                     9.76745415         99
*/

/*
--SECTION-ID = 700835	D-spec  (=te groot voor 1x)
--ONDERZOEK OM TE KIJKEN HOE WE D-SPEC IN STUKKEN KUNNEN EXPORTEREN...
--
SELECT substr(i.object_id,1,1) obj, count(*)
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 700835
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.object_id,1,1) 
ORDER by substr(i.object_id,1,1) 
;
--
1	4584     --> blijft proces hier hangen op 10.1 GB temp-tablespace, PGA-memory USED=2GM, MAX=14GB.
4	840
5	2154
6	3718
7	3829
8	3592
9	5048

SELECT substr(i.object_id,1,2) obj, count(*)
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 700835
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.object_id,1,2) 
ORDER by substr(i.object_id,1,2) 
;
/*
--1	4584   --blijft op 10.1 GB hangen, dus toch opsplitsen...
100	666   -done, 1.8 GB
--
101	392
102	467
103	477   --done, 3.5 GB
--
104	379
105	371
106	383
107	517   --done, 4.2 GB
--
108	425
109	387
110	264   --done, 2.4 GB
--
--10	4464
--11	264
--
4	840    --done 3.7 GB
5	2154   --done 5.1 GB
--
--6	3718   --blijft op 8.5 GB hangen, dus toch opsplitsen !!1
60	381
61	368
62	427
63	425
64	55     --done 4.5 GB
--
65	180
66	430
67	471
68	621
69	360    --
--
70	382
71	476
72	595
73	455
--
74	359
75	355
76	327
77	363
78	156
79	361
--
80	474
81	352
82	334
83	264
84	356
--
85	280
86	312
87	428
88	466
89	326
--
90	312
91	502
92	658
93	386
--
94	448
95	1022
--
96	723
97	311
98	352
99	334

--
--EVT. GECOMBINEERD MET FRAME-ID ERBIJ...
--
SELECT substr(i.object_id,1,1) obj, sh.frame_id, count(*)
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 700835
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.object_id,1,1) , sh.frame_id
ORDER by substr(i.object_id,1,1) , sh.frame_id
;

*/

--

/*
--SECTION-ID = 701095	Labels and certification   (=te groot voor 1x)
--ONDERZOEK OM TE KIJKEN HOE WE D-SPEC IN STUKKEN KUNNEN EXPORTEREN...
--
SELECT substr(i.object_id,1,2) obj, count(*)
from ITOID   i
JOIN specification_section sps   ON  sps.ref_id  = i.object_id AND   sps.ref_ver = i.revision AND   sps.ref_owner = i.owner and sps.section_id = 701095
JOIN specification_header  sh    ON  sh.part_no = sps.part_no  AND sh.revision = sps.revision 
JOIN status  s                   ON  s.status = sh.status      AND s.status_type = 'CURRENT'
where sps.type in ( 6 )
--and   sps.revision = (select max(sps2.revision) from specification_section sps2 where sps2.part_no = sps.part_no and sps2.ref_id = sps.ref_id and sps2.ref_ver = sps.ref_ver)
group by substr(i.object_id,1,2) 
ORDER by substr(i.object_id,1,2) 
;
--
5	10
6	992
--
64	361
65	588
66	25
67	17
69	1
--
7	15
8	7





/*
select count(*) 
from itoiraw   r
where length(r.desktop_object) > 0
;
--58904 (>0 dus wel aanwezig)
--61 bestanden leeg !!

SELECT i.file_name, i.revision, r.object_id, r.revision    
from ITOID   i
JOIN ITOIRAW r  ON  i.object_id = r.object_id AND   i.revision  = r.revision 
where substr(i.file_name, instr(i.file_name,'.',-1)+1)     like decode('overig','overig','%','overig')
and   substr(i.file_name, instr(i.file_name,'.',-1)+1) NOT IN ('pdf','txt','CATPart','stp','inc','xls','doc')
;
*/


--einde script

