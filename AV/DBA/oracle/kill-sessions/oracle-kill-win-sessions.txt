How to kill an Oracle process on Windows
Oracle Database Tips by Donald BurlesonOctober 20, 2015

Question:  I'm used to the "kill -9" syntax in UNIX for killing an Oracle process, but I don't know how to kill an Oracle process on Windows.

Answer:  In Windows Server, we have several options for killing processes.  In UNIX, we can simply issue a kill -9 to kill a running process.  
In Windows, it is not always that straightforward!  
We have the ability to use several methods to kill a process, and many will depend on the circumstances.  
For example, we can use the Task Manager for jobs we have direct permissions on, and then use the Task Manager called by the at command to kill any others.  
We can also kill a process from the command line using the taskkill or orakill commands.  
Lastly, we can delete a stuck Windows Service by finding the process ID using the sc queryex and then using taskkill.
As a quick review, you can kill an Oracle session from within Oracle, but that does not always terminate the OS process.  
First, you get the SID and serial number of the session that you want to kill:

select p.pid
,      p.serial#   proces_serial
,      p.spid
,      s.osuser
,      s.program
,      s.sid
,      s.serial#   session_serial
from   v$process p
,      v$session s
where  p.addr=s.paddr
and    s.osuser like '%Schep%'
and    s.program like '%plus%'
;

/*
  PID        PROCES_SERIAL SPID                     OSUSER                         PROGRAM                                                                           SID       SESSION_SERIAL
----- -------------------- ------------------------ ------------------------------ ---------------------------------------------------------------- -------------------- --------------------
   50                  110 6816                     APOLLOTYRES\Peter.Schepens     sqlplus.exe                                                                        72                  219
   52                    7 8564                     APOLLOTYRES\Peter.Schepens     sqlplus.exe                                                                        86                   13
   
Next, you kill the session from inside SQL*Plus:  alter system kill session 'mysid, myserial_no';

alter system kill session 'IS61, 6816';


You can also invoke the dbms_sql.kill_session procedure to kill a Windows session from inside Oracle.
Also see Kill stuck Windows service using sc queryex and taskkill
Killing a Windows Task
In Windows we have several utilities, the Oracle-centric "orakill" utility and the Windows "taskkill" program.  
The Windows command to kill this session would be as follows.
In this example, the windows thread corresponding to the Oracle session can be killed in the operating system without ever logging into the database.
The orakillcommand is very simple. In fact, it is essentially the exact same syntax as the ALTER SYSTEM KILL SESSION. This means that it accepts two parameters 
- the SID 
- and v$process.spid 
which represents the thread number (!!!!!)

orakill IS61 6816
 

You can also use the Windows taskkill utility to remove an Oracle Windows process:
TASKLIST [/S system [/U username [/P [password]]]]
         [/M [module] | /SVC | /V] [/FI filter] [/FO format] [/NH]

Description:
    This tool displays a list of currently running processes on
    either a local or remote machine.

Parameter List:
   /S     system           Specifies the remote system to connect to.
   /U     [domain\]user    Specifies the user context under which the command should execute.
   /P     [password]       Specifies the password for the given user context. Prompts for input if omitted.
   /M     [module]         Lists all tasks currently using the given exe/dll name. If the module name is not specified all loaded modules are displayed.
   /SVC                    Displays services hosted in each process.
   /APPS                   Displays Store Apps and their accociated processes
   /V                      Displays verbose task information.
   /FI    filter           Displays a set of tasks that match a given criteria specified by the filter.
   /FO    format           Specifies the output format. Valid values: "TABLE", "LIST", "CSV".
   /NH                     Specifies that the "Column Header" should not be displayed in the output. Valid only for "TABLE" and "CSV" formats.
   /?                      Displays this help message.

Filters:
    Filter Name     Valid Operators           Valid Value(s)
    -----------     ---------------           --------------------------
    STATUS          eq, ne                    RUNNING | SUSPENDED | NOT RESPONDING | UNKNOWN
    IMAGENAME       eq, ne                    Image name
    PID             eq, ne, gt, lt, ge, le    PID value
    SESSION         eq, ne, gt, lt, ge, le    Session number
    SESSIONNAME     eq, ne                    Session name
    CPUTIME         eq, ne, gt, lt, ge, le    CPU time in the format of hh:mm:ss.hh - hours, mm - minutes, ss - seconds
    MEMUSAGE        eq, ne, gt, lt, ge, le    Memory usage in KB
    USERNAME        eq, ne                    User name in [domain\]user format
    SERVICES        eq, ne                    Service name
    WINDOWTITLE     eq, ne                    Window title
    MODULES         eq, ne                    DLL name

NOTE: "WINDOWTITLE" and "STATUS" filters are not supported when querying a remote machine.

Examples:
    TASKLIST
    TASKLIST /M
    TASKLIST /V /FO CSV
    TASKLIST /SVC /FO LIST
    TASKLIST /APPS /FI "STATUS eq RUNNING"
    TASKLIST /M wbem*
    TASKLIST /S system /FO LIST
    TASKLIST /S system /U domain\username /FO CSV /NH
    TASKLIST /S system /U username /P password /FO TABLE /NH
    TASKLIST /FI "USERNAME ne NT AUTHORITY\SYSTEM" /FI "STATUS eq running"
	

 

c:>tasklist

oracle.exe 						9311 Console 				0 	5,072 K

tasklist /FI "IMAGENAME eq oracle.exe"
Image Name                     PID Session Name        Session#    Mem Usage
========================= ======== ================ =========== ============
oracle.exe                    2912 Services                   0  8,567,024 K
oracle.exe                    2976 Services                   0  3,567,348 K
oracle.exe                    3012 Services                   0  8,670,452 K 

tasklist /FI "IMAGENAME eq sqlplus.exe"

Image Name                     PID Session Name        Session#    Mem Usage
========================= ======== ================ =========== ============
sqlplus.exe                   8212 RDP-Tcp#6                  5     23,016 K

c:>taskkill /pid 8212

SUCCESS: The process with PID 9311 has been terminated.
 

Using the Windows Task Manager to Kill a Process
The simplest way to delete a process, if you can tell which you want to delete, is by using the Task Manager.  In the example seen in Figure 9.1, the cmd.exe process is highlighted and then End Process is clicked.   That will kill the process, as long as we have permissions to it.



However, sometimes the process you need to kill is running under another user's credentials and Task Manager will not allow you to kill it.  
There is a solution.  If you recall from the chapter on Batch Jobs, we learned that the at command submits jobs as the system user.  Here we use that to our advantage.
To kill a job regardless of owner, we simply open a command prompt and submit a Task Manager process to start interactively within the next few minutes.
For example, if it is 9:58am and we need to do this, we tell it to start at 10am (2 minutes later). 
 
C:\>  at 10:00 /interactive taskmgr.exe
 
When 10:00am arrives, a Task Manager window will pop up on your screen, running as System.  From there you will have full permissions to kill any process you need to.

Killing Processes Using taskkill
The way you delete processes from the command prompt is to use the taskkill command.  The syntax is:
C:\>  taskkill /PID
So, for example, to delete process ID 223, you would type:
C:\>  taskkill /PID 223
The process ID can be had from using the tasklist command.


